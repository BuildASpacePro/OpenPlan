import{j as e,V as C}from"./ViewToggle.-WxgrB4c.js";import{R as _,r as d}from"./index.B52nOzfP.js";function D({groundStations:g=[]}){const[a,m]=d.useState("name"),[h,x]=d.useState("asc"),p=d.useMemo(()=>g.sort((s,w)=>{let r=s[a],n=w[a];return(a==="created_at"||a==="updated_at")&&(r=new Date(r),n=new Date(n)),(a==="latitude"||a==="longitude"||a==="altitude")&&(r=parseFloat(r),n=parseFloat(n)),typeof r=="string"&&(r=r.toLowerCase(),n=n.toLowerCase()),h==="asc"?r<n?-1:r>n?1:0:r>n?-1:r<n?1:0}),[g,a,h]),l=s=>{a===s?x(h==="asc"?"desc":"asc"):(m(s),x("asc"))},N=s=>{if(!s)return"-";try{return new Date(s).toLocaleString()}catch{return s}},j=s=>s==null?"-":parseFloat(s).toFixed(6),c=s=>a!==s?e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):h==="asc"?e.jsx("svg",{className:"w-4 h-4 text-astro-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"})}):e.jsx("svg",{className:"w-4 h-4 text-astro-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-astro-dark",children:"Ground Stations"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[p.length," stations"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>l("name"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Name"}),c("name")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>l("latitude"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Latitude"}),c("latitude")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>l("longitude"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Longitude"}),c("longitude")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>l("altitude"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Altitude (m)"}),c("altitude")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Coverage"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>l("created_at"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Created"}),c("created_at")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full mr-3"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-mono",children:[j(s.latitude),"째"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-mono",children:[j(s.longitude),"째"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.altitude?`${parseInt(s.altitude).toLocaleString()} m`:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-2"}),e.jsx("span",{children:"Active"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"10째 min elevation"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:N(s.created_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"text-astro-blue hover:text-astro-light",onClick:()=>console.log("View station:",s.gs_id),title:"View Details",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),e.jsx("button",{className:"text-green-600 hover:text-green-500",onClick:()=>console.log("View access windows:",s.gs_id),title:"Access Windows",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{className:"text-yellow-600 hover:text-yellow-500",onClick:()=>console.log("Edit station:",s.gs_id),title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})})]},s.gs_id))})]})}),p.length===0&&e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsxs("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("p",{children:"No ground stations found"})]})]})]})}const W=_.memo(D);function V(){const[g,a]=d.useState("cards"),[m,h]=d.useState([]),[x,p]=d.useState({}),[l,N]=d.useState(!0),[j,c]=d.useState(null),s=[{key:"cards",label:"Cards",icon:"grid"},{key:"table",label:"Table",icon:"table"}];d.useEffect(()=>{w()},[]);const w=async()=>{try{N(!0),c(null);const t=await fetch("/api/groundstations");if(!t.ok)throw new Error(`Failed to fetch ground stations: ${t.status}`);const i=await t.json();h(i);const f=i.map(async o=>{try{const v=new Date,L=new Date(v.getTime()+24*60*60*1e3),y=await fetch(`/api/accesswindows/groundstation/${o.gs_id}?start_time=${v.toISOString()}&end_time=${L.toISOString()}`);if(y.ok){const S=await y.json();return{stationId:o.gs_id,windows:S.access_windows||[]}}return{stationId:o.gs_id,windows:[]}}catch(v){return console.warn(`Failed to fetch access windows for station ${o.gs_id}:`,v),{stationId:o.gs_id,windows:[]}}}),b=await Promise.all(f),u={};b.forEach(o=>{u[o.stationId]=o.windows}),p(u)}catch(t){c(t.message),console.error("Error fetching ground stations:",t)}finally{N(!1)}},r=t=>t==null?"N/A":`${parseFloat(t).toFixed(4)}째`,n=t=>{const i=x[t]||[];if(i.length===0)return null;const f=new Date,b=i.filter(u=>new Date(u.start_time)>f);return b.length===0?null:b.sort((u,o)=>new Date(u.start_time)-new Date(o.start_time))[0]},k=()=>l?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-astro-blue border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-astro-gray",children:"Loading ground station data..."})]}):j?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900",children:"Error Loading Ground Stations"}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:j})]})]}),e.jsx("button",{onClick:w,className:"mt-4 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm",children:"Retry"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-astro-dark mb-4",children:"Active Ground Stations"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(t=>{const i=n(t.gs_id),f=(x[t.gs_id]||[]).length;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),e.jsx("h3",{className:"font-medium text-gray-900",children:t.name})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",t.gs_id]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Location:"})," ",r(t.latitude),", ",r(t.longitude)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Altitude:"})," ",t.altitude?`${parseInt(t.altitude).toLocaleString()} m`:"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Access Windows (24h):"})," ",f]}),i&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Next Access:"}),e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[new Date(i.start_time).toLocaleString(),e.jsx("br",{}),i.satellite_name," (",i.duration_minutes,"min)"]})]})]}),e.jsxs("div",{className:"mt-4 flex space-x-2",children:[e.jsx("button",{className:"text-xs bg-astro-blue text-white px-2 py-1 rounded hover:bg-astro-light",children:"View Details"}),e.jsx("button",{className:"text-xs bg-green-600 text-white px-2 py-1 rounded hover:bg-green-700",children:"Access Windows"})]})]},t.gs_id)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-astro-dark mb-4",children:"Network Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:m.length}),e.jsx("p",{className:"text-sm text-blue-700",children:"Total Stations"})]}),e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:Object.values(x).reduce((t,i)=>t+i.length,0)}),e.jsx("p",{className:"text-sm text-green-700",children:"Access Windows (24h)"})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:Object.values(x).filter(t=>t.length>0).length}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Active Stations"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg text-center",children:[e.jsx("p",{className:"text-lg font-bold text-purple-600",children:m.length>0?new Date().toLocaleDateString():"-"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Last Update"})]})]})]})]});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(C,{currentView:g,onViewChange:a,views:s})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:w,disabled:l,className:"bg-green-600 hover:bg-green-700 disabled:opacity-50 px-4 py-2 rounded-lg font-medium transition-colors duration-200 text-white",children:l?"Loading...":"Refresh Data"})}),g==="cards"?k():e.jsx(W,{groundStations:m})]})}export{V as default};
